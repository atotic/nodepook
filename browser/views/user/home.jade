extends ../layout

block content
  link(rel="import",  href="vendor/core-drag-drop/core-drag-drop.html")
  link(rel='import', href='vendor/core-toolbar/core-toolbar.html')

  pook-user(user=JSON.stringify(user), photos=JSON.stringify(photos))
  pook-body-file-drop

  core-toolbar(style='color:white;background:#4285f4')
    span(flex)= user.email
    a(href='/auth/logout', class='paper-button') logout
  pook-flash
  pook-photolist(height=100)
  div Upload a file
  form#upload(is='pook-form', action="/photos", method="post", enctype="multipart/form-data")
    input#photoPicker(type="file", name="myPhoto")
    input(type="submit")

  div#target I am a target
    core-drag-drop

  style.
    body {
      user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;
    }
    #target {
      display: block;
      position: relative;
      width: 100px;
      height: 100px;
      border: 1px solid green;
      cursor: move;
    }
    core-drag-avatar {
      border: 1px solid gray;
      width: 100px;
      height: 100px;
      cursor: move;
    }
  script.
    // upload button
    document.querySelector('#photoPicker').addEventListener('change', function(ev) {
      document.querySelector('pook-user').addLocalPhotoFiles(this.files);
    });
    // drag'n'drop
    document.querySelector('#target')
      .addEventListener('drag-start', function(e) {
        console.log("drag start");
        var dragInfo = e.detail;
        dragInfo.drag = function() {
          document.body.style.cursor = 'move';
          console.log('drag');
        }
        dragInfo.drop = function() {
          document.body.style.cursor = '';
          console.log('drop');
        }
    });
